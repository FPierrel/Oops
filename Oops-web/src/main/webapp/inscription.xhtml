<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"          
      xmlns:p="http://primefaces.org/ui"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:pt="http://xmlns.jcp.org/jsf/passthrough">
    <h:head>
        <title>Oops | Page d'inscription</title>
        <meta charset="utf-8"/>
        <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
        <link rel="stylesheet" href="css/bootstrap.min.css"/>
        <link rel="stylesheet" href="css/font-awesome.min.css"/>
        <link rel="stylesheet" href="css/animate.css"/>
        <link rel="stylesheet" href="css/main.css"/>
        <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.2.0/css/font-awesome.min.css"/>
        <link rel="stylesheet" href="css/typeahead.css"/>
        <!--[if lt IE 9]>
        <script src="js/html5shiv.js"></script>
        <script src="js/respond.min.js"></script>
        <![endif]-->       
        <link rel="apple-touch-icon-precomposed" sizes="144x144" href="images/ico/apple-touch-icon-144-precomposed.png"/>
        <link rel="apple-touch-icon-precomposed" sizes="114x114" href="images/ico/apple-touch-icon-114-precomposed.png"/>
        <link rel="apple-touch-icon-precomposed" sizes="72x72" href="images/ico/apple-touch-icon-72-precomposed.png"/>
        <link rel="apple-touch-icon-precomposed" href="images/ico/apple-touch-icon-57-precomposed.png"/>
        <script type="text/javascript" src="js/jquery.js"/>
        <script type="text/javascript" src="js/bootstrap.min.js"/>
        <script type="text/javascript" src="js/main.js"/>
    </h:head>
    <h:body> 
        <ui:include src="header.xhtml"/>
        <section id="title" class="emerald">
            <div class="container">
                <div class="row">
                    <div class="col-sm-6">
                        <h1>Inscription</h1>
                        <p>Inscrivez-vous et créez un compte permettant l'accès au contenu complet du site.</p>
                    </div>
                    <div class="col-sm-6">
                        <ul class="breadcrumb pull-right">
                            <li><a href="index.xhtml">Accueil</a></li>
                            <li class="active">Inscription</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section><!--/#title-->    

        <section id="registration" class="normal">
            <div class="container">
                <h:form id="form_signin">
                    <h:panelGroup id="inputs">
                        <div class="row">
                            <div class="col-sm-3 col-sm-offset-3">
                                <label class="control-label">Vous êtes un : </label>
                            </div>
                            <div class="col-sm-3">
                                <div class="form-group">
                                    <h:selectOneMenu id="select" class="form-control" value="#{registrationBean.user}">
                                        <f:selectItem itemValue="Soumissionnaire" itemLabel="Soumissionnaire"/>
                                        <f:selectItem itemValue="Prestataire" itemLabel="Prestataire"/>
                                        <f:ajax render="inputs"/>
                                    </h:selectOneMenu>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-sm-4 col-sm-offset-4">
                                <fieldset>
                                    <legend>Informations du compte</legend>
                                    <div class="form-group">
                                        <h:inputText id="login" value="#{registrationBean.login}" 
                                                     binding="#{registrationBean.loginComponent}" 
                                                     pt:placeholder="Login" class="form-control" 
                                                     required="true" requiredMessage="Veuillez renseigner un login !"/>
                                        <p:message for="form_signin:login"/>
                                    </div>
                                    <div class="form-group">
                                        <h:inputSecret id="password" value="#{registrationBean.password}" 
                                                       binding="#{registrationBean.passwordComponent}" 
                                                       pt:placeholder="Mot de passe" class="form-control" 
                                                       required="true" requiredMessage="Veuillez renseigner un mot de passe !"/>
                                        <p:message for="form_signin:password"/>
                                    </div>
                                    <div class="form-group">
                                        <h:inputSecret id="confirmPassword" value="#{registrationBean.confirmPassword}" 
                                                       binding="#{registrationBean.confirmPasswordComponent}"
                                                       pt:placeholder="Confirmation du mot de passe" class="form-control"
                                                       required="true" requiredMessage="Veuillez confirmer votre mot de passe !"/>
                                        <p:message for="form_signin:confirmPassword"/>
                                    </div>
                                    <div class="form-group">
                                        <h:inputText id="email" value="#{registrationBean.email}" 
                                                     binding="#{registrationBean.emailComponent}"
                                                     pt:placeholder="E-mail" class="form-control"
                                                     required="true" requiredMessage="Veuillez renseigner votre adresse mail !"/>
                                        <p:message for="form_signin:email"/>
                                    </div>
                                </fieldset>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-sm-4 col-sm-offset-4">
                                <fieldset>
                                    <legend>Informations personnelles</legend>
                                    <div class="form-group">
                                        <h:inputText id="lastname" value="#{registrationBean.lastname}" 
                                                     binding="#{registrationBean.lastnameComponent}"
                                                     pt:placeholder="Nom" class="form-control"
                                                     required="#{registrationBean.soumissionnaire}" requiredMessage="Veuillez renseigner votre nom !"/>
                                        <p:message for="form_signin:lastname"/>
                                    </div>
                                    <div class="form-group">
                                        <h:inputText id="firstname" value="#{registrationBean.firstname}" 
                                                     binding="#{registrationBean.firstnameComponent}" 
                                                     pt:placeholder="Prénom" class="form-control"
                                                     required="#{registrationBean.soumissionnaire}" requiredMessage="Veuillez renseigner votre prénom !"/>
                                        <p:message for="form_signin:firstname"/>
                                    </div>
                                    <div class="form-group">
                                        <h:inputText id="phone" value="#{registrationBean.phone}" 
                                                     binding="#{registrationBean.phoneComponent}"
                                                     pt:placeholder="Téléphone" class="form-control"
                                                     required="#{registrationBean.prestataire}" requiredMessage="Veuillez renseigner votre numéro de téléphone !"/>
                                        <p:message for="form_signin:phone"/>
                                    </div>
                                    <div class="form-group">
                                        <h:inputText id="number" value="#{registrationBean.number}" 
                                                     binding="#{registrationBean.numberComponent}"
                                                     pt:placeholder="Numéro de rue" class="form-control"
                                                     required="#{registrationBean.prestataire}" requiredMessage="Veuillez renseigner votre numéro de rue !"/>
                                        <p:message for="form_signin:number"/>
                                    </div>
                                    <div class="form-group">
                                        <h:inputText id="street" value="#{registrationBean.street}" 
                                                     binding="#{registrationBean.streetComponent}"
                                                     pt:placeholder="Rue, Avenue..." class="form-control"
                                                     required="#{registrationBean.prestataire}" requiredMessage="Veuillez renseigner votre rue !"/>
                                        <p:message for="form_signin:street"/>
                                    </div>
                                    <div class="form-group">
                                        <h:inputText id="complement" value="#{registrationBean.complement}" 
                                                     binding="#{registrationBean.complementComponent}"
                                                     pt:placeholder="Complément" class="form-control"/>
                                        <p:message for="form_signin:complement"/>
                                    </div>
                                    <div class="form-group">
                                        <h:inputText id="town" value="#{registrationBean.town}" autocomplete="off"
                                                     binding="#{registrationBean.townComponent}"
                                                     pt:placeholder="Ville" class="typeahead form-control" 
                                                     required="true" requiredMessage="Veuillez renseigner votre ville !"/>
                                        <p:message for="form_signin:town"/>
                                    </div>
                                </fieldset>
                                <script type="text/javascript" src="js/typeahead.jquery.js"/>
                                <script type="text/javascript" src="js/bloodhound.js"/>
                                <script type="text/javascript">
                                    var dataSource = new Bloodhound({
                                        datumTokenizer: Bloodhound.tokenizers.obj.whitespace('value'),
                                        queryTokenizer: Bloodhound.tokenizers.whitespace,
                                        prefetch: 'villes.json'/*,
                                         remote: {
                                         url: 'villes.json'
                                         }*/
                                    });

                                    dataSource.initialize();

                                    $('.typeahead').typeahead({
                                        hint: true,
                                        highlight: true,
                                        minLength: 1,
                                        limit: 5
                                    }, {
                                        displayKey: 'value',
                                        source: dataSource.ttAdapter(),
                                        templates: {
                                            empty: [
                                                '<div class="empty-message">',
                                                'Pas de résultat !',
                                                '</div>'
                                            ].join('\n')
                                        }
                                    });
                                </script>
                            </div>
                        </div>
                        <h:panelGroup rendered="#{registrationBean.prestataire}">
                            <div class="row" id="infosPrestataire">
                                <div class="col-sm-4 col-sm-offset-4">
                                    <fieldset>
                                        <legend>Informations du prestataire</legend>
                                        <div class="form-group">
                                            <h:inputText id="companyName" value="#{registrationBean.companyName}" 
                                                         binding="#{registrationBean.companyNameComponent}"
                                                         pt:placeholder="Nom du prestataire" class="form-control"
                                                         required="true" requiredMessage="Veuillez renseigner votre nom de prestataire !"/>
                                            <p:message for="form_signin:companyName"/>
                                        </div>
                                        <div class="form-group">
                                            <h:selectOneMenu id="raison" class="form-control" value="#{registrationBean.forme}"> 
                                                <f:selectItems value="#{registrationBean.formes}" var="f" itemLabel="Forme juridique : #{f}" itemValue="#{f}"/>
                                            </h:selectOneMenu>
                                        </div>
                                        <div class="form-group">
                                            <h:inputText id="nbEmployee" value="#{registrationBean.employee}" 
                                                         binding="#{registrationBean.employeeComponent}" 
                                                         pt:placeholder="Nombre d'employé" class="form-control">
                                            </h:inputText>
                                            <p:message for="form_signin:nbEmployee"/>
                                        </div>
                                        <div class="form-group">
                                            <h:inputText id="turnoverNumber" value="#{registrationBean.turnover}" 
                                                         binding="#{registrationBean.turnoverComponent}" 
                                                         pt:placeholder="Chiffre d'affaire" class="form-control">
                                            </h:inputText>
                                            <p:message for="form_signin:turnoverNumber"/>
                                        </div>
                                        <div class="form-group">
                                            <h:inputText id="website" value="#{registrationBean.website}"
                                                         pt:placeholder="Site Web" class="form-control">
                                            </h:inputText>
                                        </div>
                                    </fieldset>
                                </div>
                            </div>
                        </h:panelGroup>
                        <div class="row">
                            <div class="col-sm-4 col-sm-offset-4">
                                <div class="form-group">
                                    <h:commandButton id="register" value="S'inscrire"
                                                     class="btn btn-success btn-md btn-block"
                                                     action="#{registrationBean.registration()}"/>
                                </div>
                            </div>
                        </div>
                    </h:panelGroup>
                </h:form>
            </div>
        </section><!--/#registration-->        
        <ui:include src="footer.xhtml"/> 
    </h:body>
</html>

